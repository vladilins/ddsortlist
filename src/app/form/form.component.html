<button (click)="addNewTemplate()">Add Group</button><br /><br />
<form [formGroup]="myForm">
  <div formArrayName="group">
    <div *ngFor="let skills of myForm.get('group').controls; let i = index">
      <fieldset>
        <div [formGroupName]="i">
          <label>Group: </label>
          <input formControlName="group_title" />
          <div formArrayName="skills">
            <div
              *ngFor="let skill of skills.get('skills').controls; let j = index"
            >
              <fieldset>
                <div [formGroupName]="j">
                  <label>Skill: </label>
                  <input formControlName="skill.title" />
                </div>
              </fieldset>
            </div>
            <button (click)="addNewProperty(skills.controls.skills)">
              Add Skill
            </button>
          </div>
        </div>
      </fieldset>
    </div>
  </div>
  <br />
</form>

<pre>{{ myForm.value | json }}</pre>

<!-- New -->

<!-- Group Form -->

<div class="card">
  <div class="card-body">
    <form (ngSubmit)="addNewTemplate()">
      <div class="form-group">
        <label for="skill">Group</label>
        <input
          type="text"
          class="form-control"
          name="title"
          [(ngModel)]="title"
          required
        />
      </div>

      <input type="submit" value="Submit" class="btn btn-primary btn-block" />
    </form>
  </div>
</div>

<!-- Display group -->
<div
  class="container"
  *ngFor="let skills of myForm.get('group').controls; let i = index"
>
  <h4>
    {{ skills.title }}
  </h4>
  <div
    cdkDropList
    cdkDropListOrientation="horizontal"
    class="example-list"
    (cdkDropListDropped)="drop($event)"
    [cdkDropListData]="skills"
  >
    <!-- Display skills -->
    <div
      class="example-box"
      *ngFor="let skill of skills.get('skills').controls; let j = index"
      [cdkDragData]="skill"
      cdkDrag
    >
      <!-- Skill create form -->
      <ng-template #content let-modal>
        <div class="modal-header">
          <h4 class="modal-title" id="modal-basic-title">Add Skills</h4>
          <button
            type="button"
            class="close"
            aria-label="Close"
            (click)="modal.dismiss('Cross click')"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="card">
          <div class="card-body">
            <form (ngSubmit)="addNewProperty(skill.controls.skills)">
              <div class="form-group">
                <label for="skill">Skill</label>
                <input
                  type="text"
                  class="form-control"
                  name="title"
                  [(ngModel)]="skill.title"
                  required
                />
              </div>

              <div class="form-group">
                <label for="years">Years</label>
                <input
                  type="number"
                  class="form-control"
                  [(ngModel)]="skill.years"
                  name="years"
                  required
                />
              </div>

              <input
                type="submit"
                value="Submit"
                class="btn btn-primary btn-block"
              />
            </form>
          </div>
        </div>
      </ng-template>
      {{ skill.title }} / {{ skill.years }}
    </div>
    <button class="btn btn-lg btn-outline-primary" (click)="open(content)">
      Add
    </button>
  </div>
</div>
